<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>관리자 · 스타일 커스터마이저</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg: #f4f7fb;
        --card: #ffffff;
        --muted: #6b7280;
        --accent: #3b82f6;
        --glass: rgba(255, 255, 255, 0.6);
        --radius: 14px;
        --shadow: 0 8px 30px rgba(15, 23, 42, 0.06);
      }
      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 28px;
        font-family: Inter, system-ui, Arial;
        background: radial-gradient(
            1200px 400px at 10% 10%,
            rgba(59, 130, 246, 0.06),
            transparent
          ),
          linear-gradient(180deg, #fbfdff 0%, #f4f7fb 100%);
        color: #0f1724;
      }

      .container {
        max-width: 1100px;
        margin: 0 auto;
        display: grid;
        grid-template-columns: 1fr 420px;
        gap: 20px;
        align-items: start;
      }
      header {
        grid-column: 1/-1;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
      }
      .brand {
        display: flex;
        gap: 12px;
        align-items: center;
      }
      .brand .logo {
        width: 44px;
        height: 30px;
        border-radius: 8px;
        background: linear-gradient(90deg, var(--accent), #7aa7ff);
        display: flex;
        align-items: center;
        justify-content: center;
        color: #fff;
        font-weight: 700;
      }
      h1 {
        margin: 0;
        font-size: 18px;
      }
      .desc {
        color: var(--muted);
        font-size: 13px;
      }

      .card {
        background: var(--card);
        border-radius: var(--radius);
        padding: 18px;
        box-shadow: var(--shadow);
        min-height: 120px;
      }
      .controls {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
      }
      label {
        display: block;
        font-size: 13px;
        color: #334155;
        margin-bottom: 6px;
      }
      select,
      input[type="text"],
      input[type="number"] {
        width: 100%;
        padding: 10px;
        border: 1px solid #e6e9ef;
        border-radius: 10px;
        font-size: 14px;
        background: #fff;
      }
      input[type="color"] {
        width: 46px;
        height: 40px;
        padding: 0;
        border-radius: 8px;
        border: 1px solid #e6e9ef;
      }
      .row {
        display: flex;
        gap: 8px;
        align-items: center;
      }

      .actions {
        display: flex;
        gap: 8px;
        margin-top: 14px;
        flex-wrap: wrap;
        align-items: center;
      }
      .btn {
        padding: 9px 14px;
        border-radius: 10px;
        border: 0;
        cursor: pointer;
        font-weight: 600;
      }
      .btn-primary {
        background: var(--accent);
        color: #fff;
        box-shadow: 0 6px 18px rgba(59, 130, 246, 0.12);
      }
      .btn-outline {
        background: transparent;
        border: 1px solid #e6e9ef;
        color: var(--muted);
      }
      .hintBox {
        margin-left: auto;
        display: flex;
        gap: 8px;
        align-items: center;
        font-size: 13px;
        color: var(--muted);
      }
      .pill {
        display: inline-flex;
        gap: 8px;
        align-items: center;
        padding: 8px 12px;
        border-radius: 999px;
        background: linear-gradient(
          90deg,
          rgba(59, 130, 246, 0.06),
          rgba(59, 130, 246, 0.02)
        );
        border: 1px solid rgba(59, 130, 246, 0.04);
        font-weight: 600;
        color: #0b1220;
      }

      /* 미리보기 */
      .preview {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }
      .mock {
        display: flex;
        gap: 12px;
        align-items: stretch;
        padding: 12px;
        border-radius: 12px;
        background: linear-gradient(
          180deg,
          rgba(59, 130, 246, 0.03),
          rgba(59, 130, 246, 0.01)
        );
      }
      .leftMock {
        width: 132px;
        background: rgba(255, 255, 255, 0.85);
        border-radius: 10px;
        padding: 12px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
      }
      .mockLogo {
        width: 72px;
        height: 44px;
        border-radius: 8px;
        background: var(--card);
        box-shadow: 0 6px 20px rgba(15, 23, 42, 0.05);
      }
      .mockMenu {
        display: flex;
        flex-direction: column;
        gap: 8px;
        width: 100%;
        margin-top: 6px;
      }
      .mockItem {
        height: 36px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 13px;
        color: var(--muted);
        background: transparent;
      }
      .mockItem.active {
        color: var(--accent);
        font-weight: 700;
        background: rgba(59, 130, 246, 0.06);
      }
      .iconRow {
        display: flex;
        gap: 8px;
        margin-top: 6px;
      }
      .iconBtn {
        width: 36px;
        height: 36px;
        border-radius: 8px;
        background: transparent;
        border: 1px solid #eef2f7;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--muted);
      }
      .bannerMock {
        flex: 1;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #fff;
        font-weight: 700;
        height: 84px;
        background: linear-gradient(90deg, var(--accent), #7aa7ff);
      }

      pre {
        background: #0b1220;
        color: #e6eefb;
        padding: 10px;
        border-radius: 10px;
        overflow: auto;
        font-size: 13px;
        line-height: 1.4;
      }

      footer {
        grid-column: 1/-1;
        text-align: right;
        color: var(--muted);
        font-size: 13px;
        margin-top: 8px;
      }

      /* 메뉴 항목 호버/포커스 효과 */
      .mockItem {
        position: relative;
        transition: color 0.18s ease, transform 0.12s ease,
          background 0.18s ease;
        cursor: default;
      }
      .mockItem::after {
        content: "";
        position: absolute;
        left: 12px;
        right: 12px;
        bottom: 8px;
        height: 2px;
        background: var(--menu-underline);
        transform: scaleX(0);
        transform-origin: left center;
        transition: transform 0.22s cubic-bezier(0.2, 0.9, 0.3, 1);
        border-radius: 2px;
        pointer-events: none;
      }
      .mockItem:hover,
      .mockItem:focus {
        color: var(--text);
        transform: translateY(-3px);
      }
      .mockItem:hover::after,
      .mockItem.active::after {
        transform: scaleX(1);
      }
      .mockItem:focus {
        outline: none;
        box-shadow: 0 6px 18px rgba(59, 130, 246, 0.12);
        border-radius: 8px;
      }

      @media (max-width: 980px) {
        .container {
          grid-template-columns: 1fr;
        }
        .preview {
          order: 2;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <div class="brand">
          <div class="logo">EG</div>
          <div>
            <h1>스타일 커스터마이저</h1>
            <div class="desc">
              색상 · 폰트 · 로고 등 사이트 스타일을 실시간으로 설정합니다.
            </div>
          </div>
        </div>
        <div style="display: flex; gap: 8px; align-items: center">
          <a
            href="index.html"
            class="btn btn-outline"
            aria-label="홈으로"
            title="홈으로"
          >
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              aria-hidden="true"
              fill="currentColor"
              style="vertical-align: middle"
            >
              <path d="M12 3l9 8h-3v8h-12v-8h-3z" />
            </svg>
          </a>
          <button id="resetBtn" class="btn btn-outline" title="초기화">
            초기화
          </button>
        </div>
      </header>

      <section class="card">
        <div class="controls">
          <div>
            <label for="font">글꼴 (font-family)</label>
            <select id="font" aria-label="글꼴 선택">
              <option
                value="Inter, system-ui, -apple-system, 'Segoe UI', Roboto, Arial"
              >
                Inter / System
              </option>
              <option value="Roboto, system-ui, Arial, sans-serif">
                Roboto
              </option>
              <option value="Helvetica, Arial, sans-serif">
                Helvetica / Arial
              </option>
              <option value="Georgia, 'Times New Roman', Times, serif">
                Serif (Georgia)
              </option>
            </select>
          </div>

          <div>
            <label for="darkMode">다크모드 기본</label>
            <div class="row">
              <input id="darkMode" type="checkbox" /> 적용 여부
            </div>
          </div>

          <div>
            <label for="accent">액센트 색</label>
            <div class="row">
              <input id="accent" type="color" value="#3b82f6" />
              <input id="accentText" type="text" placeholder="#3b82f6" />
            </div>
          </div>

          <div>
            <label for="menuHover">메뉴 호버/텍스트 색</label>
            <div class="row">
              <input id="menuHover" type="color" value="#334155" />
              <input id="menuHoverText" type="text" placeholder="#334155" />
            </div>
          </div>

          <div>
            <label for="menuUnderline">메뉴 밑줄 색</label>
            <div class="row">
              <input id="menuUnderline" type="color" value="#3b82f6" />
              <input id="menuUnderlineText" type="text" placeholder="#3b82f6" />
            </div>
          </div>

          <div>
            <label>로고 크기 (W × H px)</label>
            <div class="row">
              <input id="logoW" type="number" min="24" max="300" value="70" />
              <span class="desc" style="margin-left: 6px">px</span>
              <input
                id="logoH"
                type="number"
                min="16"
                max="200"
                value="50"
                style="margin-left: 8px"
              />
              <span class="desc" style="margin-left: 6px">px</span>
            </div>
          </div>
        </div>

        <div class="actions">
          <button id="saveBtn" class="btn btn-primary">저장</button>
          <button id="exportBtn" class="btn btn-outline">CSS 복사</button>
          <button id="applyInlineBtn" class="btn btn-outline">
            주입 스니펫 복사
          </button>

          <div class="hintBox">
            <div class="pill" title="저장 방식">
              <svg
                width="14"
                height="14"
                viewBox="0 0 24 24"
                fill="currentColor"
                style="opacity: 0.9"
              >
                <path d="M5 4v2h14V4H5zm0 4v12h14V8H5zm2 2h10v8H7v-8z" />
              </svg>
              저장은 localStorage에 보관됩니다. 새로고침 또는 '주입 스니펫'으로
              실제 페이지에 적용하세요.
            </div>
          </div>
        </div>
      </section>

      <aside class="card preview">
        <div class="mock" id="mockPreview">
          <div class="leftMock">
            <div class="mockLogo" id="mockLogo"></div>
            <div class="mockMenu" id="mockMenu">
              <div class="mockItem active">PROFILE</div>
              <div class="mockItem">NOTICE</div>
              <div class="mockItem">GALLERY</div>
              <div class="mockItem">DIARY</div>
              <div class="mockItem">MEMO</div>
            </div>
            <div class="iconRow">
              <div class="iconBtn" title="설정">⚙</div>
              <div class="iconBtn" title="글쓰기">✎</div>
            </div>
          </div>
          <div class="bannerMock" id="mockBanner">MAIN BANNER</div>
        </div>

        <div>
          <h4 style="margin: 8px 0 6px">생성될 CSS (미리보기)</h4>
          <pre id="cssPreview">/* 미리보기 */</pre>
        </div>
      </aside>

      <footer>
        적용 후 index.html을 새로고침하거나 주입 스니펫을 사용하세요.
      </footer>
    </div>

    <script>
      const defaults = {
        font: "Inter, system-ui, -apple-system, 'Segoe UI', Roboto, Arial",
        accent: "#3b82f6",
        menuUnderline: "#3b82f6",
        menuHover: "#334155",
        logoW: 70,
        logoH: 50,
        darkMode: false,
      };
      const $ = (id) => document.getElementById(id);
      function sanitizeColor(v, fallback) {
        if (!v) return fallback;
        const m = v.trim();
        return /^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(m) ? m : fallback;
      }

      // site + mock 양쪽에 적용될 CSS 생성
      function buildCSS(s) {
        const accent = sanitizeColor(s.accent, defaults.accent);
        const menuUl = sanitizeColor(s.menuUnderline, accent);
        const text = sanitizeColor(s.menuHover, defaults.menuHover);

        // 실제 사이트용 셀렉터 + 미리보기 mock용 셀렉터 병행
        return `
:root{
  --accent: ${accent};
  --menu-underline: ${menuUl};
  --text: ${text};
}
body{font-family: ${s.font};}

/* 실제 사이트 */
.left-menu li::after{ background: var(--menu-underline) !important; }
.left-menu li:hover{ color: var(--text) !important; }
.logo-image{ width: ${Number(s.logoW) || defaults.logoW}px; height: ${
          Number(s.logoH) || defaults.logoH
        }px; }

/* mock 미리보기에 적용되는 동일 스타일 (실제 적용과 최대한 일치) */
.mockItem::after{ content:""; display:block; height:2px; background:var(--menu-underline); transform:scaleX(0); transition:transform .22s ease; border-radius:2px; margin-top:6px; }
.mockItem:hover{ color: var(--text); }
.mockItem:hover::after, .mockItem.active::after{ transform:scaleX(1); }
.mockLogo{ width: ${Number(s.logoW) || defaults.logoW}px; height: ${
          Number(s.logoH) || defaults.logoH
        }px; }
.bannerMock{ background: linear-gradient(90deg, ${accent}, #7aa7ff); }

${
  s.darkMode
    ? "html,body{background:#0b1220;color:#e6eefb}\n:root{--bg:#0b1220;--card:#111}"
    : ""
}
`.trim();
      }

      // mock 전용 스타일 태그(실시간 적용)
      let mockStyle = document.getElementById("mockStyle");
      if (!mockStyle) {
        mockStyle = document.createElement("style");
        mockStyle.id = "mockStyle";
        document.head.appendChild(mockStyle);
      }

      function updatePreview(s) {
        const css = buildCSS(s);
        $("cssPreview").textContent = css;
        // 실시간 적용: mockStyle에 삽입 (또는 실제 페이지에 주입되는 CSS와 동일)
        mockStyle.textContent = css;

        // mock visual update (추가 보정)
        document.documentElement.style.setProperty(
          "--accent",
          sanitizeColor(s.accent, defaults.accent)
        );
        document.documentElement.style.setProperty(
          "--menu-underline",
          sanitizeColor(s.menuUnderline, s.accent)
        );
        document.documentElement.style.setProperty(
          "--text",
          sanitizeColor(s.menuHover, defaults.menuHover)
        );
        $("mockLogo").style.width = (Number(s.logoW) || defaults.logoW) + "px";
        $("mockLogo").style.height = (Number(s.logoH) || defaults.logoH) + "px";
        $(
          "mockBanner"
        ).style.background = `linear-gradient(90deg, ${sanitizeColor(
          s.accent,
          defaults.accent
        )}, #7aa7ff)`;
        if (s.darkMode) {
          document.body.style.background = "#071226";
        } else {
          document.body.style.background = "";
        }
      }

      function currentState() {
        return {
          font: $("font").value,
          accent: $("accentText").value || $("accent").value,
          menuUnderline:
            $("menuUnderlineText").value || $("menuUnderline").value,
          menuHover: $("menuHoverText").value || $("menuHover").value,
          logoW: Number($("logoW").value),
          logoH: Number($("logoH").value),
          darkMode: $("darkMode").checked,
        };
      }

      // events
      ["accent", "menuUnderline", "menuHover"].forEach((id) => {
        $(id).addEventListener("input", (e) => {
          $(id + "Text").value = e.target.value;
          updatePreview(currentState());
        });
        $(id + "Text").addEventListener("input", (e) => {
          $(id).value = e.target.value;
          updatePreview(currentState());
        });
      });
      ["logoW", "logoH", "font", "darkMode"].forEach((id) =>
        $(id).addEventListener("input", () => updatePreview(currentState()))
      );

      $("saveBtn").addEventListener("click", () => {
        const s = currentState();
        s.accent = sanitizeColor(s.accent, defaults.accent);
        s.menuUnderline = sanitizeColor(s.menuUnderline, s.accent);
        s.menuHover = sanitizeColor(s.menuHover, defaults.menuHover);
        localStorage.setItem("siteCustomizer", JSON.stringify(s));
        updatePreview(s);
        const t = document.createElement("div");
        t.textContent = "저장되었습니다.";
        t.style.position = "fixed";
        t.style.right = "18px";
        t.style.bottom = "18px";
        t.style.background = "rgba(15,23,42,0.92)";
        t.style.color = "#fff";
        t.style.padding = "10px 14px";
        t.style.borderRadius = "8px";
        t.style.boxShadow = "0 8px 30px rgba(2,6,23,0.4)";
        document.body.appendChild(t);
        setTimeout(() => t.remove(), 1800);
      });

      $("exportBtn").addEventListener("click", async () => {
        const css = buildCSS(
          Object.assign(
            {},
            defaults,
            JSON.parse(localStorage.getItem("siteCustomizer") || "{}")
          )
        );
        try {
          await navigator.clipboard.writeText(css);
          alert("CSS가 클립보드에 복사되었습니다.");
        } catch (e) {
          prompt("복사 실패. 아래 CSS를 복사하세요:", css);
        }
      });

      $("applyInlineBtn").addEventListener("click", () => {
        const s = Object.assign(
          {},
          defaults,
          JSON.parse(localStorage.getItem("siteCustomizer") || "{}")
        );
        const snippet = `(function(){const s=${JSON.stringify(
          s
        )};const css=\` :root{--accent:\${s.accent};--menu-underline:\${s.menuUnderline};--text:\${s.menuHover};} .logo-image{width:\${s.logoW}px;height:\${s.logoH}px;} .left-menu li::after{ background: var(--menu-underline) !important; } .left-menu li:hover{ color: var(--text) !important; }\`;const style=document.createElement('style');style.id='siteCustomizerStyle';style.appendChild(document.createTextNode(css));document.head.appendChild(style);if(s.darkMode)document.documentElement.classList.add('dark-mode');})();`;
        try {
          navigator.clipboard.writeText(snippet);
          alert("주입 스니펫이 클립보드에 복사되었습니다.");
        } catch (e) {
          prompt(
            "복사 실패. 아래 스니펫을 index.html에 붙여넣으세요:",
            snippet
          );
        }
      });

      $("resetBtn").addEventListener("click", () => {
        // soft reset (미리보기만 초기화, 저장 유지)
        $("font").value = defaults.font;
        $("accent").value = defaults.accent;
        $("accentText").value = defaults.accent;
        $("menuUnderline").value = defaults.menuUnderline;
        $("menuUnderlineText").value = defaults.menuUnderline;
        $("menuHover").value = defaults.menuHover;
        $("menuHoverText").value = defaults.menuHover;
        $("logoW").value = defaults.logoW;
        $("logoH").value = defaults.logoH;
        $("darkMode").checked = defaults.darkMode;
        updatePreview(defaults);
      });

      function loadSettings() {
        const s = Object.assign(
          {},
          defaults,
          JSON.parse(localStorage.getItem("siteCustomizer") || "{}")
        );
        $("font").value = s.font;
        $("accent").value = s.accent;
        $("accentText").value = s.accent;
        $("menuUnderline").value = s.menuUnderline;
        $("menuUnderlineText").value = s.menuUnderline;
        $("menuHover").value = s.menuHover;
        $("menuHoverText").value = s.menuHover;
        $("logoW").value = s.logoW;
        $("logoH").value = s.logoH;
        $("darkMode").checked = !!s.darkMode;
        updatePreview(s);
      }

      loadSettings();
    </script>
  </body>
</html>
